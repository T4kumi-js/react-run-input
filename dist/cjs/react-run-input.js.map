{"version":3,"file":"react-run-input.js","sources":["../../src/utils/keyboard-events.js","../../src/utils/run.js","../../src/components/RUNInput/RUNInput.jsx"],"sourcesContent":["/**\n * @param {KeyboardEvent} event\n * @returns {boolean}\n */\nexport function isControlKey(event) {\n    const KEYS = [\n        8,  // Backspace\n        9,  // Tab\n        17, // Control\n        35, // End\n        36, // Home\n        37, // ArrowLeft\n        38, // ArrowUp\n        39, // ArrowRight\n        40, // ArrowDown\n        46, // Delete\n        91  // Command (for macOS)\n    ];\n\n    return KEYS.includes(event.keyCode);\n}\n\n/**\n * @param {KeyboardEvent} event\n * @returns {boolean}\n */\nexport function isCtrlOrCmdKey(event) {\n    const KEYS = [\n        17, // Control\n        91  // Command (for macOS)\n    ];\n\n    return KEYS.includes(event.keyCode);\n}\n\n/**\n * @param {KeyboardEvent} event\n * @returns {boolean}\n */\nexport function isEditKey(event) {\n    const KEYS = [\n        67, // C\n        86, // V\n        88  // X\n    ];\n\n    return KEYS.includes(event.keyCode);\n}\n","/**\n * @param {string} run\n * @returns {{dv: string, numRUN: string}}\n */\nexport function cleanAndSplitRUN(run) {\n    let cleanRUN = run?.replace(/[\\.\\-]/g, ''),\n        numRUN = '',\n        dv = '';\n\n    if (cleanRUN?.length === 1) {\n        numRUN = cleanRUN;\n    } else if (cleanRUN?.length > 1) {\n        numRUN = cleanRUN.slice(0, -1);\n        dv = cleanRUN.slice(-1).toUpperCase();\n    }\n\n    return { numRUN, dv };\n}\n\n/**\n * @param {string} run\n * @returns {string}\n */\nexport function cleanRUN(run) {\n    const { numRUN, dv } = cleanAndSplitRUN(run);\n    return numRUN + dv;\n}\n\n/**\n * @param {string} run\n * @returns {boolean}\n */\nexport function checkRUN(run) {\n    const isNumber = /^\\d+$/;\n    const { numRUN, dv } = cleanAndSplitRUN(run);\n\n    if (!(numRUN && dv && isNumber.test(numRUN))) return false;\n\n    let calculation = 0,\n        series = 2,\n        validDV;\n\n    for (let i = numRUN.length - 1; i >= 0; i--) {\n        if (series > 7) series = 2;\n        calculation += (series * numRUN.charAt(i));\n        series++;\n    }\n\n    calculation = 11 - (calculation % 11);\n\n    if (calculation === 10) {\n        validDV = 'K';\n    } else if (calculation === 11) {\n        validDV = '0';\n    } else {\n        validDV = calculation.toString();\n    }\n\n    return dv === validDV;\n}\n\n/**\n * @param {string} run\n * @returns {string}\n */\nexport function formatRUN(run) {\n    let { numRUN, dv } = cleanAndSplitRUN(run);\n    let formattedRUN = '';\n\n    while (numRUN.length > 3) {\n        formattedRUN = '.' + numRUN.slice(numRUN.length - 3) + formattedRUN;\n        numRUN = numRUN.slice(0, numRUN.length - 3);\n    }\n\n    formattedRUN = numRUN + formattedRUN;\n\n    return (dv) ? `${formattedRUN}-${dv}` : formattedRUN;\n}\n","import React, { useState } from 'react';\nimport {\n    isControlKey,\n    isCtrlOrCmdKey,\n    isEditKey,\n    cleanRUN,\n    formatRUN\n} from '../../utils';\n\nfunction RUNInput(props) {\n    const { value: externalValue, handleChangeValue, ...DOMProps } = props;\n    const [ctrlDown, setCtrlDown] = useState(false);\n    const [localValue, setLocalValue] = useState('' || externalValue);\n\n    const handleInput = (event) => {\n        const run = cleanRUN(event.target.value);\n\n        setLocalValue(run);\n\n        if (handleChangeValue) {\n            handleChangeValue(run);\n        }\n    };\n\n    const handleKeyDown = (event) => {\n        const keyFilter = /[\\dK]/;\n\n        if (isCtrlOrCmdKey(event)) {\n            setCtrlDown(true);\n        }\n\n        if (!(\n            keyFilter.test(event.key.toUpperCase()) ||\n            isControlKey(event) ||\n            ctrlDown && isEditKey(event)\n        )) {\n            event.preventDefault();\n        }\n    };\n\n    const handleKeyUp = (event) => {\n        if (isCtrlOrCmdKey(event)) {\n            setCtrlDown(false);\n        }\n    };\n\n    return (\n        <input {...DOMProps}\n            type=\"text\"\n            maxLength=\"12\"\n            value={formatRUN(localValue)}\n            onInput={handleInput}\n            onKeyDown={handleKeyDown}\n            onKeyUp={handleKeyUp}\n        />\n    );\n}\n\nexport default RUNInput;\n"],"names":["isControlKey","event","KEYS","includes","keyCode","isCtrlOrCmdKey","isEditKey","cleanAndSplitRUN","run","cleanRUN","replace","numRUN","dv","length","slice","toUpperCase","checkRUN","isNumber","test","calculation","series","validDV","i","charAt","toString","formatRUN","formattedRUN","RUNInput","props","value","externalValue","handleChangeValue","DOMProps","ctrlDown","setCtrlDown","useState","localValue","setLocalValue","handleInput","target","handleKeyDown","keyFilter","key","preventDefault","handleKeyUp"],"mappings":"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"}