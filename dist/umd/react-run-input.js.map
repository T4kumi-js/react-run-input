{"version":3,"file":"react-run-input.js","sources":["../../src/utils/keyboard-events.js","../../src/utils/run.js","../../src/components/RUNInput/RUNInput.jsx"],"sourcesContent":["/**\n * @param {KeyboardEvent} event\n * @returns {boolean}\n */\nexport function isControlKey(event) {\n    const KEYS = [\n        8,  // Backspace\n        9,  // Tab\n        17, // Control\n        35, // End\n        36, // Home\n        37, // ArrowLeft\n        38, // ArrowUp\n        39, // ArrowRight\n        40, // ArrowDown\n        46, // Delete\n        91  // Command (for macOS)\n    ];\n\n    return KEYS.includes(event.keyCode);\n}\n\n/**\n * @param {KeyboardEvent} event\n * @returns {boolean}\n */\nexport function isCtrlOrCmdKey(event) {\n    const KEYS = [\n        17, // Control\n        91  // Command (for macOS)\n    ];\n\n    return KEYS.includes(event.keyCode);\n}\n\n/**\n * @param {KeyboardEvent} event\n * @returns {boolean}\n */\nexport function isEditKey(event) {\n    const KEYS = [\n        67, // C\n        86, // V\n        88  // X\n    ];\n\n    return KEYS.includes(event.keyCode);\n}\n","/**\n * @param {string} run\n * @returns {{dv: string, numRUN: string}}\n */\nexport function cleanAndSplitRUN(run) {\n    let cleanRUN = run?.replace(/[\\.\\-]/g, ''),\n        numRUN = '',\n        dv = '';\n\n    if (cleanRUN?.length === 1) {\n        numRUN = cleanRUN;\n    } else if (cleanRUN?.length > 1) {\n        numRUN = cleanRUN.slice(0, -1);\n        dv = cleanRUN.slice(-1).toUpperCase();\n    }\n\n    return { numRUN, dv };\n}\n\n/**\n * @param {string} run\n * @returns {string}\n */\nexport function cleanRUN(run) {\n    const { numRUN, dv } = cleanAndSplitRUN(run);\n    return numRUN + dv;\n}\n\n/**\n * @param {string} run\n * @returns {boolean}\n */\nexport function checkRUN(run) {\n    const isNumber = /^\\d+$/;\n    const { numRUN, dv } = cleanAndSplitRUN(run);\n\n    if (!(numRUN && dv && isNumber.test(numRUN))) return false;\n\n    let calculation = 0,\n        series = 2,\n        validDV;\n\n    for (let i = numRUN.length - 1; i >= 0; i--) {\n        if (series > 7) series = 2;\n        calculation += (series * numRUN.charAt(i));\n        series++;\n    }\n\n    calculation = 11 - (calculation % 11);\n\n    if (calculation === 10) {\n        validDV = 'K';\n    } else if (calculation === 11) {\n        validDV = '0';\n    } else {\n        validDV = calculation.toString();\n    }\n\n    return dv === validDV;\n}\n\n/**\n * @param {string} run\n * @returns {string}\n */\nexport function formatRUN(run) {\n    let { numRUN, dv } = cleanAndSplitRUN(run);\n    let formattedRUN = '';\n\n    while (numRUN.length > 3) {\n        formattedRUN = '.' + numRUN.slice(numRUN.length - 3) + formattedRUN;\n        numRUN = numRUN.slice(0, numRUN.length - 3);\n    }\n\n    formattedRUN = numRUN + formattedRUN;\n\n    return (dv) ? `${formattedRUN}-${dv}` : formattedRUN;\n}\n","import React, { useState } from 'react';\nimport {\n    isControlKey,\n    isCtrlOrCmdKey,\n    isEditKey,\n    cleanRUN,\n    formatRUN\n} from '../../utils';\n\nfunction RUNInput(props) {\n    const { value: externalValue, handleChangeValue, ...DOMProps } = props;\n    const [ctrlDown, setCtrlDown] = useState(false);\n    const [localValue, setLocalValue] = useState('' || externalValue);\n\n    const handleInput = (event) => {\n        const run = cleanRUN(event.target.value);\n\n        setLocalValue(run);\n\n        if (handleChangeValue) {\n            handleChangeValue(run);\n        }\n    };\n\n    const handleKeyDown = (event) => {\n        const keyFilter = /[\\dK]/;\n\n        if (isCtrlOrCmdKey(event)) {\n            setCtrlDown(true);\n        }\n\n        if (!(\n            keyFilter.test(event.key.toUpperCase()) ||\n            isControlKey(event) ||\n            ctrlDown && isEditKey(event)\n        )) {\n            event.preventDefault();\n        }\n    };\n\n    const handleKeyUp = (event) => {\n        if (isCtrlOrCmdKey(event)) {\n            setCtrlDown(false);\n        }\n    };\n\n    return (\n        <input {...DOMProps}\n            type=\"text\"\n            maxLength=\"12\"\n            value={formatRUN(localValue)}\n            onInput={handleInput}\n            onKeyDown={handleKeyDown}\n            onKeyUp={handleKeyUp}\n        />\n    );\n}\n\nexport default RUNInput;\n"],"names":["isControlKey","event","KEYS","includes","keyCode","isCtrlOrCmdKey","isEditKey","cleanAndSplitRUN","run","cleanRUN","replace","numRUN","dv","length","slice","toUpperCase","checkRUN","isNumber","test","calculation","series","validDV","i","charAt","toString","formatRUN","formattedRUN","RUNInput","props","value","externalValue","handleChangeValue","DOMProps","ctrlDown","setCtrlDown","useState","localValue","setLocalValue","handleInput","target","handleKeyDown","keyFilter","key","preventDefault","handleKeyUp"],"mappings":"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"}